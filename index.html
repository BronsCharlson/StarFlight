<!DOCTYPE html>
<html>
<head>
    <title>StarFlight - Space Shooter Game</title>
    <style>
        body { margin: 0; overflow: hidden; background: #222; }
        #symbol { 
            position: absolute; 
            font-size: 30px; 
            color: #00ffff; 
            top: 50%; 
            left: 50%;
            transform-origin: center center;
        }
        @keyframes pulse {
            0% { transform: scale(1); color: #00ffff; }
            100% { transform: scale(1.1); color: #ffffff; }
        }
        .tail {
            position: absolute;
            font-size: 40px;
            color: white;
            pointer-events: none;
            transition: transform 0.1s;
        }
        .asteroid {
            position: absolute;
            font-size: 20px;
            color: #888;
        }
        .laser {
            position: absolute;
            width: 3px;
            height: 20px;
            background: red;
            border-radius: 2px;
        }
    </style>
</head>
<body>
    <div id="symbol">ðŸš€</div>
    <div id="debug" style="position: fixed; top: 10px; left: 10px; color: white; font-family: monospace;"></div>
    <script>
        const symbol = document.getElementById('symbol');
        const debug = document.getElementById('debug');
        let x = window.innerWidth / 2;
        let y = window.innerHeight / 2;
        let dx = 3;
        let dy = 2;
        let trail = [];
        
        // Audio context for sound effects
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        
        function playLaserSound() {
            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            
            oscillator.frequency.setValueAtTime(800, audioCtx.currentTime);
            oscillator.frequency.exponentialRampToValueAtTime(200, audioCtx.currentTime + 0.1);
            gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.1);
            
            oscillator.start(audioCtx.currentTime);
            oscillator.stop(audioCtx.currentTime + 0.1);
        }
        
        function playExplosionSound() {
            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            
            oscillator.type = 'sawtooth';
            oscillator.frequency.setValueAtTime(150, audioCtx.currentTime);
            oscillator.frequency.exponentialRampToValueAtTime(50, audioCtx.currentTime + 0.3);
            gainNode.gain.setValueAtTime(0.5, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
            
            oscillator.start(audioCtx.currentTime);
            oscillator.stop(audioCtx.currentTime + 0.3);
        }
        
        function playThrusterSound() {
            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            
            oscillator.type = 'sawtooth';
            oscillator.frequency.setValueAtTime(80 + Math.random() * 20, audioCtx.currentTime);
            gainNode.gain.setValueAtTime(0.1, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.1);
            
            oscillator.start(audioCtx.currentTime);
            oscillator.stop(audioCtx.currentTime + 0.1);
        }
        
        // Create asteroids
        const asteroids = [];
        const lasers = [];
        
        function createAsteroid() {
            const asteroid = document.createElement('div');
            asteroid.className = 'asteroid';
            asteroid.textContent = 'ðŸª¨';
            const x = Math.random() * window.innerWidth;
            const y = Math.random() * window.innerHeight;
            asteroid.style.left = x + 'px';
            asteroid.style.top = y + 'px';
            document.body.appendChild(asteroid);
            
            asteroids.push({
                element: asteroid,
                x: x,
                y: y,
                dx: (Math.random() - 0.5) * 0.5,
                dy: (Math.random() - 0.5) * 0.5
            });
        }
        
        for (let i = 0; i < 6; i++) {
            createAsteroid();
        }
        
        // Spawn new asteroid every 10 seconds
        setInterval(createAsteroid, 10000);
        
        function animate() {
            x += dx;
            y += dy;
            
            if (x <= 0 || x >= window.innerWidth - 40) dx = -dx;
            if (y <= 0 || y >= window.innerHeight - 40) dy = -dy;
            
            const angle = Math.atan2(dy, dx) * (180 / Math.PI) + 90;
            symbol.style.left = x + 'px';
            symbol.style.top = y + 'px';
            symbol.style.transform = `rotate(${angle}deg)`;
            
            debug.textContent = `dx: ${dx.toFixed(1)}, dy: ${dy.toFixed(1)}, angle: ${angle.toFixed(1)}Â°`;
            
            // Move and check lasers
            for (let i = lasers.length - 1; i >= 0; i--) {
                const laser = lasers[i];
                laser.x += laser.dx;
                laser.y += laser.dy;
                laser.element.style.left = laser.x + 'px';
                laser.element.style.top = laser.y + 'px';
                
                // Remove laser if off screen
                if (laser.x < 0 || laser.x > window.innerWidth || laser.y < 0 || laser.y > window.innerHeight) {
                    laser.element.remove();
                    lasers.splice(i, 1);
                    continue;
                }
                
                // Check laser-asteroid collisions
                for (let j = asteroids.length - 1; j >= 0; j--) {
                    const ast = asteroids[j];
                    const distX = laser.x - ast.x;
                    const distY = laser.y - ast.y;
                    const distance = Math.sqrt(distX * distX + distY * distY);
                    
                    if (distance < 25) {
                        // Explosion! Remove both laser and asteroid
                        playExplosionSound();
                        laser.element.remove();
                        ast.element.remove();
                        lasers.splice(i, 1);
                        asteroids.splice(j, 1);
                        break;
                    }
                }
            }
            
            // Move asteroids
            asteroids.forEach(ast => {
                ast.x += ast.dx;
                ast.y += ast.dy;
                if (ast.x <= 0 || ast.x >= window.innerWidth - 20) ast.dx = -ast.dx;
                if (ast.y <= 0 || ast.y >= window.innerHeight - 20) ast.dy = -ast.dy;
                ast.element.style.left = ast.x + 'px';
                ast.element.style.top = ast.y + 'px';
                
                // Collision detection with rocket
                const distX = x - ast.x;
                const distY = y - ast.y;
                const distance = Math.sqrt(distX * distX + distY * distY);
                
                if (distance < 30) {
                    // Collision! Exchange velocities (elastic collision)
                    const tempDx = dx;
                    const tempDy = dy;
                    dx = ast.dx * 8; // Scale up asteroid velocity for rocket
                    dy = ast.dy * 8;
                    ast.dx = tempDx * 0.3; // Scale down rocket velocity for asteroid
                    ast.dy = tempDy * 0.3;
                    
                    // Separate objects to prevent sticking
                    const angle = Math.atan2(distY, distX);
                    x = ast.x + Math.cos(angle) * 35;
                    y = ast.y + Math.sin(angle) * 35;
                }
            });
            
            // Tail with offset
            const tailOffsetX = -Math.cos(Math.atan2(dy, dx)) * 15;
            const tailOffsetY = -Math.sin(Math.atan2(dy, dx)) * 15;
            
            trail.push({x: x + tailOffsetX, y: y + tailOffsetY, age: 0});
            
            trail.forEach((point, index) => {
                point.age++;
                const existingEl = document.querySelector(`[data-trail="${index}"]`);
                if (existingEl) {
                    const scale = Math.max(0.2, 1 - (point.age * 0.15));
                    const opacity = Math.max(0.1, 1 - (point.age * 0.12));
                    existingEl.style.transform = `scale(${scale})`;
                    existingEl.style.opacity = opacity;
                }
            });
            
            if (trail.length > 8) {
                const old = trail.shift();
                const oldEl = document.querySelector(`[data-trail="0"]`);
                if (oldEl) oldEl.remove();
                
                document.querySelectorAll('.tail').forEach((el, index) => {
                    el.setAttribute('data-trail', index);
                });
            }
            
            const tailEl = document.createElement('div');
            tailEl.className = 'tail';
            tailEl.textContent = 'ðŸ”¥';
            tailEl.style.left = (x + tailOffsetX) + 'px';
            tailEl.style.top = (y + tailOffsetY) + 'px';
            tailEl.style.transform = 'scale(1)';
            tailEl.style.opacity = '1';
            tailEl.setAttribute('data-trail', trail.length - 1);
            document.body.appendChild(tailEl);
            
            requestAnimationFrame(animate);
        }
        
        animate();
        
        document.addEventListener('keydown', (e) => {
            switch(e.key) {
                case 'ArrowUp': 
                    dy -= 0.5; 
                    playThrusterSound();
                    break;
                case 'ArrowDown': 
                    dy += 0.5; 
                    playThrusterSound();
                    break;
                case 'ArrowLeft': 
                    dx -= 0.5; 
                    playThrusterSound();
                    break;
                case 'ArrowRight': 
                    dx += 0.5; 
                    playThrusterSound();
                    break;
                case '+': 
                case '=': 
                    dx *= 1.1; dy *= 1.1; 
                    playThrusterSound();
                    break;
                case '-': 
                    dx *= 0.9; dy *= 0.9; 
                    playThrusterSound();
                    break;
                case ' ':
                    // Fire laser
                    playLaserSound();
                    const laserAngle = Math.atan2(dy, dx);
                    const laser = document.createElement('div');
                    laser.className = 'laser';
                    laser.style.left = x + 'px';
                    laser.style.top = y + 'px';
                    laser.style.transform = `rotate(${laserAngle * 180 / Math.PI + 90}deg)`;
                    document.body.appendChild(laser);
                    
                    lasers.push({
                        element: laser,
                        x: x,
                        y: y,
                        dx: Math.cos(laserAngle) * 8,
                        dy: Math.sin(laserAngle) * 8
                    });
                    break;
            }
        });
    </script>
</body>
</html>
